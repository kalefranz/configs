#!/bin/bash -eux

#################################################
# Create all the relevant symlinks for file
# in this repo
#################################################

LINK_THESE_FILENAMES=".gitconfig .gitignore_global .zlogin .zshenv .zpreztorc .zshrc"

# http://stackoverflow.com/questions/59895/can-a-bash-script-tell-what-directory-its-stored-in
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )" # the directory this file is in
cd $SCRIPT_DIR


# files_from_home=$(find files_from_home -name '*' -type f)
# files_from_root=$(find files_from_root -name '*' -type f)

# for file in files_from_home; do
# 	local fullfile=${file#"files_from_home/"}  # strip "files_from_home/"
# 	local file_dir=$(basename file)
# 	local file_name="${file##*/}"
# 	mkdir -p "$HOME/$file_dir"
#     ln -s -f "$SCRIPT_DIR/files_from_home/$file" "$HOME/$file_dir/$file_name"
# done


link_file_from_home() {
	local fullname=$1
	local file_dir=$(dirname "$fullname")
	local file_name=$(basename "$fullname")
	mkdir -p "$HOME/$file_dir"
	ln -s -f "$SCRIPT_DIR/files_from_home/$fullname" "$HOME/$file_dir/$file_name"
}

link_files_from_home() {
	cd files_from_home
	find . -name '*' -type f | while read fname; do
  		link_file_from_home $fname
	done
	cd $SCRIPT_DIR
}

link_files_from_home

# link_folder() {
# 	local folder_name=$1

# 	find . -name \*.iso -print0 | xargs -0 process

# 	file_list=$(cd "$folder_name" && find . -name '*' -type f)
# 	for file in "$file_list"; do
# 		local file_dir=$(dirname "$file")
# 		local file_name=$(basename "$file")
# 		mkdir -p "$HOME/$file_dir"
# 	    ln -s -f "$SCRIPT_DIR/$file" "$HOME/$file_dir/$file_name"
# 	done
# }
# link_folder files_from_home



ln -s -f $SCRIPT_DIR/files_other/prompt_kale_setup $HOME/.zprezto/modules/prompt/functions/prompt_kale_setup

if [ -e $SCRIPT_DIR/.zshrc.include ]; then
    ln -s -f $SCRIPT_DIR/files_from_home/.zshrc.include $HOME/.zshrc.include
fi

sudo -p 'elevate privileges for symlinks in /etc
sudo password: ' ln -s -f $SCRIPT_DIR/files_from_root/etc_zshenv /etc/zshenv


# function link_anaconda() {
# 	echo "linking anaconda python in /usr/local/anaconda/bin"
# 	for f in $(ls /usr/local/anaconda/bin); do
# 		sudo ln -fs "/usr/local/anaconda/bin/$f" "/usr/local/bin/$f"
# 	done
# }
# link_anaconda
